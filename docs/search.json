[{"path":"https://wnbo9.github.io/DAPS/articles/getting-started.html","id":"daps-with-individual-level-data","dir":"Articles","previous_headings":"","what":"DAPS with Individual-level Data","title":"Getting started with DAPS","text":"","code":"# Load the DAPS package library(DAPS)  # Run DAP-S fine-mapping set.seed(1234) n <- 1000 p <- 1000 beta <- rep(0, p) beta[c(1, 200, 500, 800)] <- 1 X <- matrix(rnorm(n*p), nrow = n, ncol = p) X <- scale(X, center = TRUE, scale = TRUE) y <- X %*% beta + rnorm(n) rst <- daps(X, y, L = 5) rst$sets #> $sets #> $sets$S1 #> [1] 800 #>  #> $sets$S2 #> [1] 200 #>  #> $sets$S3 #> [1] 500 #>  #> $sets$S4 #> [1] 1 #>  #>  #> $purity #>    min.abs.corr mean.abs.corr median.abs.corr #> S1            1             1               1 #> S2            1             1               1 #> S3            1             1               1 #> S4            1             1               1 #>  #> $set_index #> [1] 1 2 3 4 #>  #> $coverage #> [1] 1 1 1 1 #>  #> $min_abs_corr #> [1] 0.5 #>  #> $requested_coverage #> NULL"},{"path":"https://wnbo9.github.io/DAPS/articles/getting-started.html","id":"daps-with-sufficient-statistics","dir":"Articles","previous_headings":"","what":"DAPS with Sufficient Statistics","title":"Getting started with DAPS","text":"DAPS also designed also work efficiently using sufficient statistics, includes ùêóTùêó,ùêóTùê≤,ùê≤Tùê≤,n\\boldsymbol{X}^T\\boldsymbol{X}, \\;\\boldsymbol{X}^T\\boldsymbol{y}, \\; \\boldsymbol{y}^T\\boldsymbol{y}, \\; n.","code":"XtX <- crossprod(X) Xty <- as.numeric(crossprod(X, y)) yty <- sum(y^2) rst <- daps_ss(XtX, Xty, yty, n, L = 5) rst$sets #> $sets #> $sets$S1 #> [1] 800 #>  #> $sets$S2 #> [1] 200 #>  #> $sets$S3 #> [1] 500 #>  #> $sets$S4 #> [1] 1 #>  #>  #> $purity #>    min.abs.corr mean.abs.corr median.abs.corr #> S1            1             1               1 #> S2            1             1               1 #> S3            1             1               1 #> S4            1             1               1 #>  #> $set_index #> [1] 1 2 3 4 #>  #> $coverage #> [1] 1 1 1 1 #>  #> $min_abs_corr #> [1] 0.5 #>  #> $requested_coverage #> NULL"},{"path":"https://wnbo9.github.io/DAPS/articles/getting-started.html","id":"daps-with-regression-summary-statistics","dir":"Articles","previous_headings":"","what":"DAPS with Regression Summary Statistics","title":"Getting started with DAPS","text":"common scenario genetics GWAS regression summary statistics (e.g., Z-scores LD matrices). can use recover necessary inputs DAP-S fine-mapping.","code":"rss <- susieR::univariate_regression(X, y) z <- rss$betahat / rss$sebetahat R <- cor(X) rst <- daps_rss(z = z, R = R, n = n) rst$sets #> $sets #> $sets$S1 #> [1] 800 #>  #> $sets$S2 #> [1] 200 #>  #> $sets$S3 #> [1] 500 #>  #> $sets$S4 #> [1] 1 #>  #>  #> $purity #>    min.abs.corr mean.abs.corr median.abs.corr #> S1            1             1               1 #> S2            1             1               1 #> S3            1             1               1 #> S4            1             1               1 #>  #> $set_index #> [1] 1 2 3 4 #>  #> $coverage #> [1] 1 1 1 1 #>  #> $min_abs_corr #> [1] 0.5 #>  #> $requested_coverage #> NULL"},{"path":"https://wnbo9.github.io/DAPS/articles/plotting-results.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Plotting DAPS results","text":"vignette demonstrates visualize posterior inclusion probabilities (PIPs), signal clusters credible sets DAPS using daps_plot() function. main plotting function produces two-panel figure: Top panel: SNP-level posterior inclusion probabilities Bottom panel: Signal clusters credible sets, showing cluster indices left cluster-level posterior probabilities (CPIP) coverage probabilities right","code":""},{"path":"https://wnbo9.github.io/DAPS/articles/plotting-results.html","id":"example","dir":"Articles","previous_headings":"","what":"Example","title":"Plotting DAPS results","text":"illustrate workflow using N3finemapping example dataset susieR. DAPS can visualize results directly:","code":"library(DAPS) library(susieR)  X <- N3finemapping$X Y <- N3finemapping$Y[, 1] fitted <- daps(X, Y, L = 10)  daps_plot(fitted)"},{"path":"https://wnbo9.github.io/DAPS/articles/plotting-results.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Plotting DAPS results","text":"daps_plot() function provides clear compact visualization fine-mapping results, making easy explore: SNP-level PIP patterns Signal clusters credible sets CPIP coverage probabilities enables effective interpretation DAP-S SuSiE output genomic studies.","code":""},{"path":"https://wnbo9.github.io/DAPS/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Bo Wang. Author, maintainer. Xiaoquan Wen. Author.","code":""},{"path":"https://wnbo9.github.io/DAPS/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Wang B, Wen X (2025). DAPS: Deterministic Approximation Posteriors. R package version 1.0.0, https://github.com/wnbo9/DAPS, https://wnbo9.github.io/DAPS/.","code":"@Manual{,   title = {DAPS: Deterministic Approximation of Posteriors},   author = {Bo Wang and Xiaoquan Wen},   year = {2025},   note = {R package version 1.0.0, https://github.com/wnbo9/DAPS},   url = {https://wnbo9.github.io/DAPS/}, }"},{"path":[]},{"path":"https://wnbo9.github.io/DAPS/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"DAPS","text":"DAPS R package implementing DAP-S (Deterministic Approximation Posteriors) algorithm Bayesian genetic fine-mapping. DAP-S combines computational efficiency SuSiE‚Äôs variational approximation accuracy interpretability Bayesian Variable Selection Regression (BVSR) model using DAP framework. method provides fast, scalable, well-calibrated approach identifying causal genetic variants constructing interpretable signal clusters, enable flexible construction credible sets.","code":""},{"path":"https://wnbo9.github.io/DAPS/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"DAPS","text":"","code":"# install the package via devtools install.packages(\"devtools\") devtools::install_github(\"wnbo9/DAPS\") # load the package library(DAPS)"},{"path":"https://wnbo9.github.io/DAPS/index.html","id":"vignettes","dir":"","previous_headings":"","what":"Vignettes","title":"DAPS","text":"See vignettes quick start worked examples.","code":""},{"path":"https://wnbo9.github.io/DAPS/index.html","id":"blas-acceleration","dir":"","previous_headings":"","what":"BLAS acceleration","title":"DAPS","text":"DAPS relies linear algebra operations. linked optimized BLAS implementation-OpenBLAS, Intel MKL, Apple‚Äôs Accelerate-framework-DAPS can substantially faster using reference (Netlib) BLAS shipped base R. modern R installations already use optimized BLAS, performance can vary across systems. can check BLAS library R session using : simple benchmark verify optimized BLAS use: rough guideline, elapsed time order ~1 second indicates R installation likely using optimized BLAS.","code":"sessionInfo() m <- 5000 A <- matrix(rnorm(m^2), m, m) system.time(A %*% A)"},{"path":"https://wnbo9.github.io/DAPS/reference/DAPS-package.html","id":null,"dir":"Reference","previous_headings":"","what":"DAPS: Deterministic Approximation of Posteriors for Bayesian fine-mapping ‚Äî DAPS-package","title":"DAPS: Deterministic Approximation of Posteriors for Bayesian fine-mapping ‚Äî DAPS-package","text":"DAPS implements DAP-S algorithm Bayesian genetic fine-mapping, integrating SuSiE's variational approximation deterministic posterior computation identify causal variants construct interpretable signal clusters.","code":""},{"path":[]},{"path":"https://wnbo9.github.io/DAPS/reference/DAPS-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"DAPS: Deterministic Approximation of Posteriors for Bayesian fine-mapping ‚Äî DAPS-package","text":"Maintainer: Bo Wang wnbo@umich.edu Authors: Xiaoquan Wen","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/daps_main.html","id":null,"dir":"Reference","previous_headings":"","what":"DAPS main function in Rcpp ‚Äî daps_main","title":"DAPS main function in Rcpp ‚Äî daps_main","text":"DAPS main function Rcpp","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/daps_main.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DAPS main function in Rcpp ‚Äî daps_main","text":"","code":"daps_main(   X,   y,   n,   prior,   proposal,   proposal_thresh,   grid,   twas_weight,   min_abs_corr )"},{"path":"https://wnbo9.github.io/DAPS/reference/daps_main.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DAPS main function in Rcpp ‚Äî daps_main","text":"X Genotype matrix (n x p) y Phenotype vector (n x 1) n Sample size (scalar) prior Prior inclusion probabilities (p x 1) proposal Proposal matrix (p x L) SuSiE proposal_thresh Proposal threshold (scalar) grid Grid scaled prior variance values (k x 1) twas_weight Logical indicating whether use TWAS weights min_abs_corr Minimum absolute correlation TWAS weights (scalar)","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/daps_main.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"DAPS main function in Rcpp ‚Äî daps_main","text":"list containing models input data","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/daps_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"DAP-S PIP plot with cluster / credible-set annotation ‚Äî daps_plot","title":"DAP-S PIP plot with cluster / credible-set annotation ‚Äî daps_plot","text":"DAP-S PIP plot cluster / credible-set annotation","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/daps_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DAP-S PIP plot with cluster / credible-set annotation ‚Äî daps_plot","text":"","code":"daps_plot(res, band = 0)"},{"path":"https://wnbo9.github.io/DAPS/reference/daps_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DAP-S PIP plot with cluster / credible-set annotation ‚Äî daps_plot","text":"res list DAP-S fine-mapping results. band Fraction row gap allowed lifting 0 1; default 0.","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/daps_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"DAP-S PIP plot with cluster / credible-set annotation ‚Äî daps_plot","text":"ggplot object (patchwork layout).","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/daps_rss.html","id":null,"dir":"Reference","previous_headings":"","what":"DAP-S fine-mapping with regression summary statistics ‚Äî daps_rss","title":"DAP-S fine-mapping with regression summary statistics ‚Äî daps_rss","text":"DAP-S fine-mapping using regression summary statistics recover sufficient statistics.","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/daps_rss.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DAP-S fine-mapping with regression summary statistics ‚Äî daps_rss","text":"","code":"daps_rss(   z = NULL,   R,   n = NULL,   bhat = NULL,   shat = NULL,   var_y = NULL,   estimate_residual_variance = FALSE,   ... )"},{"path":"https://wnbo9.github.io/DAPS/reference/daps_rss.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DAP-S fine-mapping with regression summary statistics ‚Äî daps_rss","text":"z p-vector single-SNP z-scores. R p x p LD matrix among SNPs. n Sample size. bhat p-vector single-SNP effect size estimates. shat p-vector standard errors bhat. bhat shat together can replaced z. var_y Phenotypic variance, defined y'y/(n-1). provided, algorithm works standardized data. estimate_residual_variance Estimate residual variance SuSiE. Default FALSE. sample LD matrix used, recommend setting TRUE. ... parameters passed daps_suff_stat.","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/daps_rss.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"DAP-S fine-mapping with regression summary statistics ‚Äî daps_rss","text":"list DAP-S fine-mapping results.","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/daps_rss.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"DAP-S fine-mapping with regression summary statistics ‚Äî daps_rss","text":"","code":"z <- c(6,7) R <- matrix(1,2,2) rst <- daps_rss(z=z, R=R) rst$pip #>      [,1] #> [1,]  NaN #> [2,]  NaN"},{"path":"https://wnbo9.github.io/DAPS/reference/daps_ss.html","id":null,"dir":"Reference","previous_headings":"","what":"DAP-S fine-mapping with sufficient statistics ‚Äî daps_ss","title":"DAP-S fine-mapping with sufficient statistics ‚Äî daps_ss","text":"DAP-S fine-mapping using sufficient statistics, either provided directly recovered regression summary statistics.","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/daps_ss.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DAP-S fine-mapping with sufficient statistics ‚Äî daps_ss","text":"","code":"daps_ss(   XtX,   Xty,   yty,   n,   L = min(10, ncol(XtX)),   standardize = FALSE,   prior = NULL,   null_wt = NULL,   estimate_residual_variance = TRUE,   proposal_thresh = 1e-06,   grid = c(0.04, 0.16, 0.64),   twas_weight = FALSE,   coverage = NULL,   min_abs_corr = 0.5,   ... )"},{"path":"https://wnbo9.github.io/DAPS/reference/daps_ss.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DAP-S fine-mapping with sufficient statistics ‚Äî daps_ss","text":"XtX p x p matrix X'X columns X centered p number SNPs. Xty p-vector X'y y columns X centered. yty scalar y'y y centered. n Sample size. L Maximum number causal SNPs allowed model.  Default min(10, p). standardize Standardize column X y. Default FALSE. prior SNP-level prior weights, given vector length p. Default NULL corresponds uninformative weights. null_wt Null weight used SuSiE, defined prior probability causal variants region. Default calculated prod(1 - prior). estimate_residual_variance Estimate residual variance SuSiE. Default TRUE. proposal_thresh Threshold proposal acceptance. Default value 1e-6. grid Grid values scaled effect size prior variance. Default c(0.04, 0.16, 0.64). twas_weight Compute TWAS weights. Default FALSE. coverage Coverage level credible set (e.g. 0.95). Default NULL, algorithm returns signal clusters constrained fixed coverage level. min_abs_corr Minimum absolute correlation allowed signal cluster credible set. Default 0.5, corresponds squared correlation 0.25. ... parameters passed susie_suff_stat.","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/daps_ss.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"DAP-S fine-mapping with sufficient statistics ‚Äî daps_ss","text":"list DAP-S fine-mapping results.","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/daps_ss.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"DAP-S fine-mapping with sufficient statistics ‚Äî daps_ss","text":"","code":"set.seed(1234) n <- 1000 p <- 1000 beta <- rep(0, p) beta[c(1, 200, 500, 800)] <- 1 X <- matrix(rnorm(n*p), nrow = n, ncol = p) X <- scale(X, center = TRUE, scale = TRUE) y <- X %*% beta + rnorm(n) y <- scale(y, center = TRUE, scale = FALSE) XtX <- crossprod(X) Xty <- as.numeric(crossprod(X, y)) yty <- sum(y^2) rst <- daps_ss(XtX, Xty, yty, n, L = 5) rst$sets #> $sets #> $sets$S1 #> [1] 800 #>  #> $sets$S2 #> [1] 200 #>  #> $sets$S3 #> [1] 500 #>  #> $sets$S4 #> [1] 1 #>  #>  #> $purity #>    min.abs.corr mean.abs.corr median.abs.corr #> S1            1             1               1 #> S2            1             1               1 #> S3            1             1               1 #> S4            1             1               1 #>  #> $set_index #> [1] 1 2 3 4 #>  #> $coverage #> [1] 1 1 1 1 #>  #> $min_abs_corr #> [1] 0.5 #>  #> $requested_coverage #> NULL #>  daps_plot(rst)"},{"path":"https://wnbo9.github.io/DAPS/reference/daps_ss_main.html","id":null,"dir":"Reference","previous_headings":"","what":"DAPS_SS main function in Rcpp ‚Äî daps_ss_main","title":"DAPS_SS main function in Rcpp ‚Äî daps_ss_main","text":"DAPS_SS main function Rcpp","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/daps_ss_main.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DAPS_SS main function in Rcpp ‚Äî daps_ss_main","text":"","code":"daps_ss_main(   XtX,   Xty,   yty,   n,   prior,   proposal,   proposal_thresh,   grid,   twas_weight,   min_abs_corr )"},{"path":"https://wnbo9.github.io/DAPS/reference/daps_ss_main.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DAPS_SS main function in Rcpp ‚Äî daps_ss_main","text":"XtX Cross-product genotype matrix (p x p) Xty Cross-product genotype phenotype vector (p x 1) yty Cross-product phenotype vector (scalar) n Sample size (scalar) prior Prior inclusion probabilities (p x 1) proposal Proposal matrix (p x L) SuSiE proposal_thresh Proposal threshold (scalar) grid Grid scaled prior variance values (k x 1) twas_weight Logical indicating whether use TWAS weights min_abs_corr Minimum absolute correlation TWAS weights (scalar)","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/daps_ss_main.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"DAPS_SS main function in Rcpp ‚Äî daps_ss_main","text":"list containing models input data","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/get_enloc.html","id":null,"dir":"Reference","previous_headings":"","what":"DAP-S variant-level table for eQTL/enloc-style outputs ‚Äî get_enloc","title":"DAP-S variant-level table for eQTL/enloc-style outputs ‚Äî get_enloc","text":"Construct variant-level data frame listing variants inside signal cluster (coverage = NULL) credible set (coverage given).","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/get_enloc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DAP-S variant-level table for eQTL/enloc-style outputs ‚Äî get_enloc","text":"","code":"get_enloc(output, coverage = NULL)"},{"path":"https://wnbo9.github.io/DAPS/reference/get_enloc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DAP-S variant-level table for eQTL/enloc-style outputs ‚Äî get_enloc","text":"output list DAP-S fine-mapping results. coverage Desired coverage credible sets. NULL, use full signal clusters.","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/get_enloc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"DAP-S variant-level table for eQTL/enloc-style outputs ‚Äî get_enloc","text":"data.frame columns: SC_ID, SNP_ID, PIP.","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/get_set.html","id":null,"dir":"Reference","previous_headings":"","what":"DAP-S fine-mapping getting signal clusters or credible sets ‚Äî get_set","title":"DAP-S fine-mapping getting signal clusters or credible sets ‚Äî get_set","text":"DAP-S fine-mapping getting signal clusters credible sets","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/get_set.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DAP-S fine-mapping getting signal clusters or credible sets ‚Äî get_set","text":"","code":"get_set(output, coverage)"},{"path":"https://wnbo9.github.io/DAPS/reference/get_set.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DAP-S fine-mapping getting signal clusters or credible sets ‚Äî get_set","text":"output list DAP-S fine-mapping results. coverage Desired coverage credible sets. coverage NULL, return signal clusters instead credible sets.","code":""},{"path":"https://wnbo9.github.io/DAPS/reference/get_set.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"DAP-S fine-mapping getting signal clusters or credible sets ‚Äî get_set","text":"list signal clusters credible sets.","code":""}]
